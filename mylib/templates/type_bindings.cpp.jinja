#include "optix_types.h"
#include "mytypes.h"

#include <torch/extension.h>
PYBIND11_MODULE(types, m)
{
    {% for e in enums %}
    py::enum_<{{e.name}}>(m, "{{e.name}}")
        {% for v in e.values %}
        .value("{{v.name}}", {{v.name}})
        {% endfor %}
        .export_values();

    {% endfor %}

    {% for s in structs %}
    py::class_<{{s.name}}>(m, "{{s.name}}")
        .def(py::init<>())
        {% for f in s.fields %}
            {% if f.type.startswith('const') %}
                .def_readonly("{{f.name}}", &{{s.name}}::{{f.name}})
            {% else %}
                .def_readwrite("{{f.name}}", &{{s.name}}::{{f.name}})
            {% endif %}
        {% endfor %};

    {% endfor %}

}