#include "optix_types.h"
#include <torch/extension.h>

PYBIND11_MODULE(c_structs, m)
{
    {% for s in structs %}
    py::class_<{{s.name}}>(m, "{{s.name}}")
        .def(py::init<>())
        {% for f in s.fields %}

            {% if f.is_const%}
            .def_property_readonly(
            {% else %}
            .def_property(
            {% endif %}
            "{{f.name}}", 
            [](const {{s.name}} &self)
                { return ({{f.py_type}})(self.{{f.name}}); }, 

            {% if not f.is_const%}
            []({{s.name}} &self, {{f.py_type}} {{f.name}})
                { self.{{f.name}} = ({{f.type}}){{f.name}}; }, 
            {% endif %}
            py::return_value_policy::reference_internal)
        {% endfor %}
        ;
    {% endfor %}
}
